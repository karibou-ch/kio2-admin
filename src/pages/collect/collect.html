<!--
  Generated template for the CollectPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header no-border>
  <logistic-header
    [currentShippingDate]="shipping"
    [collect]="true"
    (doInitOrders)="onInitOrders($event)"
    (doSelectedOrders)="onSelectedOrders($event)">
    </logistic-header>
</ion-header>


<ion-content padding>
  <h1 class="info" [hidden]="!isReady||(vendors.list.length > 0)">Pas de commandes {{openShippings?'livrées':'en préparation'}} pour ce mois-ci</h1>

  <ion-refresher (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <ion-list>
    <ion-item-sliding *ngFor="let vendor of vendors.list.sort()  ">    
      <ion-item >
        <ion-avatar item-start (click)="updateCollect(vendor)">
          <span class="check" [class.collected]="isCollected(vendor)">
            <ion-icon name="apps" ></ion-icon>
          </span>
        </ion-avatar>
        <div (click)="openVendorItems(vendor)" >
          <h3 text-capitalize>{{vendor}}</h3>
          <p>Total validé: {{getAmount(vendor)}} fr</p>
        </div>

        <ion-note item-end>
          <span [class.red]="isFulfilled(vendor)">{{getFulfilled(vendor)}}</span><b>/</b>{{vendors[vendor].items.length}} 
        </ion-note>        
      </ion-item>
      <ion-item-options side="right">
        <a ion-button color="danger" href='tel:shop.address.phone'>
          <ion-icon name="call"></ion-icon>
          Appeler
        </a>        
      </ion-item-options>
    </ion-item-sliding>
  </ion-list>


</ion-content>
