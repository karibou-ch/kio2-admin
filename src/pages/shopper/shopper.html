<!--
  Generated template for the LivraisonPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->

<ion-header no-border>


  <ion-navbar color="primary">
    <!-- left toggle -->
    <ion-toggle color="light" [disabled]="currentOrders===undefined" [(ngModel)]="openShippings" (ionChange)="toggleFilter()"></ion-toggle>
    <span class="toggle-label">{{openShippings?'ouvertes':'fermées'}}</span>
    <div class="title">
        <button [disabled]="currentOrders===undefined" color="light" ion-button icon-only clear="true" (click)="openTracker()">
          <ion-icon name="pin" id="pin-icon"></ion-icon>
</button>
    </div>

    <!-- right calendar -->
    <ion-buttons end>    
      <button color="light"[disabled]="!isReady" ion-button (click)="picker.open()" clear="true" end>
        <ion-datetime #picker displayFormat="MM/YYYY" pickerFormat="MMMM YYYY" [(ngModel)]="myDate" 
          (ngModelChange)="findAllOrdersForShipping()" cancelText="Annuler" doneText="Fait" 
          monthNames="janvier, fevrier, mars, avril, mai, juin, juillet, aout, septembre, octobre, novembre, decembre">
        </ion-datetime>
        <span class="calendar-label">{{ myDate | date:"MMMM y" }}</span>
        <ion-icon name="calendar"></ion-icon>
      </button>
    </ion-buttons>

  </ion-navbar>

  <!-- SUB HEADER -->
  <ion-toolbar  color="primary" [hidden]="!shippingByDay">
    <ion-slides pager paginationType="progress" centeredSlides="false" slidesPerView="3">
      <ion-slide *ngFor="let orders of shippingByDay;let i = index">
        <button ion-button margin-top="1rem" 
                [class.selected]="i===currentOrders"
                class="slide-butt" clear small (click)="currentOrders=i" color="light" >
          {{ orders[0].shipping.when | date:'EEEE d' }}</button>
      </ion-slide>
    </ion-slides>

  </ion-toolbar>

  <!-- TODO DANS nav-bar à inclure ici!!!!
    <ion-title>Livraison</ion-title>
      <ion-buttons end>
        <button *ngIf="user.isAuthenticated()" ion-button (click)="logout()">
        <ion-icon name="log-out"></ion-icon>
      </button>
      </ion-buttons>-->

</ion-header>

<ion-content>

  <!--Actual list-->

  <ion-list>
    <ion-item-sliding *ngFor="let order of shippingByDay[currentOrders]  ">

      <ion-item>
        <ion-grid>
          <ion-row>
            <ion-col col-2 text-center>
              <ion-badge color="primary">{{ order.rank }}</ion-badge>
            </ion-col>
            <ion-col col-6>
              <h2>{{ order.shipping.name }}</h2>
            </ion-col>
            <ion-col col-4>
              <!--<ion-label>Cabas:~</ion-label>
              <ion-select [(ngModel)]="nbCabas">
                <ion-option value="1">1</ion-option>
                <ion-option value="2">2</ion-option>
                <ion-option value="3">3</ion-option>
                <ion-option value="4">4</ion-option>
              </ion-select>-->
            </ion-col>
          </ion-row>

          <ion-row wrap text-wrap>
            <ion-col col-2 text-center>
              <ion-icon name="pin" color="grey-icon"></ion-icon>
            </ion-col>
            <ion-col>
              <p>{{ order.shipping.streetAdress }}, {{order.shipping.region}} <b>{{order.shipping.postalCode}}</b>
                <br><b>Etage:</b> {{order.shipping.floor}} </p>
            </ion-col>
          </ion-row>

          <ion-row wrap text-wrap>
            <ion-col col-2 text-center>
              <ion-icon name="information-circle"></ion-icon>
            </ion-col>
            <ion-col>
              <p>{{ order.shipping.note }}</p>
            </ion-col>
          </ion-row>

        </ion-grid>
      </ion-item>

      <ion-item-options side="right">
        <button ion-button color="light">
          <ion-icon name="pin"></ion-icon>
          Carte
        </button>
        <a ion-button color="secondary" href='tel:{{order.customer.phoneNumbers[0]}}'>
          <ion-icon name="call"></ion-icon>
          Appeler
        </a>
      </ion-item-options>

    </ion-item-sliding>

  </ion-list>

</ion-content>