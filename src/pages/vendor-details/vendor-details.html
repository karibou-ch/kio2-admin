
<ion-header>
  <ion-navbar color="primary">
    <ion-title>{{shop.name}}</ion-title>
  </ion-navbar>
</ion-header>


<ion-content  [class.inactive]="!shop.status">
  <ion-list >
    <ion-item [hidden]="!(user?.isAdmin())">
      <ion-label color="primary" >
        Boutique active pour la vente
      </ion-label>
      <ion-toggle color="positive" [(ngModel)]="shop.status" [disabled]="!user.isAdmin()"></ion-toggle>
    </ion-item>
    <ion-item>
      <ion-label color="primary" floating>Description </ion-label> 
      <ion-textarea  rows="4"  placeholder="votre histoire... " [(ngModel)]="shop.description" required></ion-textarea>
    </ion-item>
    <ion-item >
      <ion-label>Grouper la liste des produits commandés</ion-label>
      <ion-toggle color="positive" [(ngModel)]="shop.info.detailledOrder" ></ion-toggle>
    </ion-item>
    
  </ion-list>      
  
  <ion-list>
      <ion-list-header color="primary">
        Informez vos clients
      </ion-list-header>
      <ion-item>
        <ion-label [class.red]="shop.available.active">Ma boutique est fermée</ion-label>
        <ion-toggle color="positive" [(ngModel)]="shop.available.active" ></ion-toggle>
      </ion-item>
      <ion-item [class.inactive]="!shop.available.active">
        <ion-label >Le jour de fermeture</ion-label>
        <ion-datetime displayFormat="DD/MM/YYYY" [(ngModel)]="shop.available.from"></ion-datetime>
      </ion-item>
  
      <ion-item [class.inactive]="!shop.available.active">
        <ion-label >Le jour de ré-ouverture</ion-label>
        <ion-datetime displayFormat="DD/MM/YYYY" [(ngModel)]="shop.available.to"></ion-datetime>
      </ion-item>
        
    </ion-list>
  
    <!-- Photos -->
    <!-- Admin BM -->
    <!-- Livraisons disponibles -->
    <!-- Adresse de collecte -->
  

  <!-- BUSINESS -->
  <ion-list [class.discount]="shop.discount.active">
    <ion-list-header color="primary">
        Fidéliser le client en lui offrant un rabais à la quantité      
    </ion-list-header>
    <ion-item>
      <ion-label color="primary">
        Activer le rabais
      </ion-label>
      <ion-toggle color="positive" [(ngModel)]="shop.discount.active"></ion-toggle>
    </ion-item>
    <ion-item [class.inactive]="!shop.discount.active">
        <ion-label color="primary" stacked>
            Le volume d'achat pour obtenir un rabais
        </ion-label> 
        <ion-input type="number" placeholder="Si le montant d'achat dépasse X.XX CHF" [(ngModel)]="shop.discount.threshold"></ion-input>              
    </ion-item>

    <ion-item [class.inactive]="!shop.discount.active">
        <ion-label color="primary" stacked>
            Combien offrez-vous au client (CHF)
        </ion-label> 
        <ion-input type="number" placeholder="Votre participation en  X.XX CHF" [(ngModel)]="shop.discount.amount"></ion-input>              
    </ion-item>    
  </ion-list>

  <!-- SHIPPING DAYS -->
  <ion-list >    
    <ion-list-header color="primary">
      Livraison
    </ion-list-header>    
    <ion-item>
      <ion-label>Lundi </ion-label>
      <ion-checkbox [(ngModel)]="weekdays[1]"></ion-checkbox>
    </ion-item>
    <ion-item>
      <ion-label>Mardi </ion-label>
      <ion-checkbox [(ngModel)]="weekdays[2]"></ion-checkbox>
    </ion-item>
    <ion-item>
      <ion-label>Mercredi </ion-label>
      <ion-checkbox [(ngModel)]="weekdays[3]"></ion-checkbox>
    </ion-item>
    <ion-item>
      <ion-label>Jeudi </ion-label>
      <ion-checkbox [(ngModel)]="weekdays[4]"></ion-checkbox>
    </ion-item>
    <ion-item>
      <ion-label>Vendredi </ion-label>
      <ion-checkbox [(ngModel)]="weekdays[5]"></ion-checkbox>
    </ion-item>
    <ion-item>
      <ion-label>Samedi </ion-label>
      <ion-checkbox [(ngModel)]="weekdays[6]"></ion-checkbox>
    </ion-item>
    <ion-item>
      <ion-label>Dimanche</ion-label>
      <ion-checkbox [(ngModel)]="weekdays[0]"></ion-checkbox>
    </ion-item>
  </ion-list>

    <!-- BUSINESS -->
  <ion-list>
    <ion-list-header color="primary">
      Business
    </ion-list-header>

    <ion-item>
      <ion-label color="primary" stacked>Votre identité TVA</ion-label> 
      <ion-input type="text" placeholder="ID TVA" [(ngModel)]="tvaId"></ion-input>              
    </ion-item>

    <ion-item>
      <ion-label color="primary" stacked>Votre IBAN</ion-label> 
      <ion-input [class.invalid-iban]="!ibanCtrl()" type="text" placeholder="CH..." [(ngModel)]="shop.account.IBAN"></ion-input>              
    </ion-item>


    <!-- SHOP FEES -->
    <ion-item [class.inactive]="!user.isAdmin()">
      <ion-label color="primary" stacked>
        Commission à la vente {{shop.account.fees|percent}}
      </ion-label> 
      <ion-input type="number" [disabled]="!user.isAdmin()" placeholder="Commission sur chaque transaction" [(ngModel)]="shop.account.fees"></ion-input>              
    </ion-item>

    <!-- SHOP WEIGHT -->
    <ion-item [class.inactive]="!user.isAdmin()">
      <ion-label color="primary" stacked>
        Poids de la boutique {{shop.scoring.weight}}
      </ion-label> 
      <ion-input type="number" [disabled]="!user.isAdmin()" placeholder="Poids de la boutique" [(ngModel)]="shop.scoring.weight"></ion-input>              
    </ion-item>
    
    <ion-item>
        <ion-label class="bold">
          Boutique créée le {{shop.created|date:'mediumDate'}} dans la catégorie {{shop.catalog?.name}}<br/>
          Validée le {{shop.account.updated|date:'mediumDate'}}
        </ion-label>
    </ion-item>
  </ion-list>    

  <!-- CATALOG -->
  <ion-item>
    <ion-label>
      Catlogue
    </ion-label>
    <ion-select [(ngModel)]="catalog">
      <ion-option *ngFor="let cat of getCatalog()"  [value]="cat._id">{{cat.name}}</ion-option>        
    </ion-select>
  </ion-item>


  <ion-list>
    <ion-item>
        <button ion-button block outline large color="primary" (click)="doSave()">Enregistrer</button>
      </ion-item>      
  </ion-list>
    
</ion-content>