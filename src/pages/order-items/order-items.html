<!--
  Generated template for the OrderItemsPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar color="primary">
    <ion-title>{{shipping| date:"d MMM"}}, {{vendor}}</ion-title>
  </ion-navbar>

</ion-header>


<ion-content >

  <h1 class="info" [hidden]="!isReady||orders.length">Pas de commandes le {{shipping|date:"d MMM"}} pour la boutique {{vendor}} </h1>

  <ion-list *ngFor="let order of orders  ">
    <ion-list-header>
      <ion-icon item-start class="rank">{{order.rank}}</ion-icon>
      <h2>
        {{order.customer.displayName}}
      </h2>
      <p> 
        {{order.shipping.streetAdress}},{{order.shipping.floor}}<br/>
        <!--<div class="">
          {{order.shipping.streetAdress}},{{order.shipping.floor}}
          Note: {{order.shipping.note}}
        </div>-->
  
      </p>
      <ion-note item-end hidden>
        {{order.oid}}
      </ion-note>
      <a item-end color="info" round ion-button outline href="tel:{{order.customer.phoneNumbers[0]?.number}}"><ion-icon name="call"> </ion-icon> </a>
      <a item-end color="info" round ion-button outline href="mailto:{{order.email}}"> <ion-icon name="mail"> </ion-icon></a>
    </ion-list-header>

    <ion-item-sliding *ngFor="let item of order.items">    
      <ion-item >
        <div item-content >
          <div class="title">
              {{item.title}} 
            <span [hidden]="!item.variant" class="red link">
              ({{item.variant?.title}})
            </span>
          </div>
          <div class="quantity" [class.red.bold]="item.quantity>1">{{item.quantity}}x <span class="part">{{item.part}}</span></div>
          <div class="price {{item.fulfillment.status}}" >
            <span class="suffix">fr</span>
            <input type="number" class="input-price" 
                   [(ngModel)]="item.finalprice"   
                   (keypress)="doKeypress($event.keyCode,order,item)"
                   (focus)="doSelectAllPrice($event)"/>
          </div>
          <div class="actions">
            <button class="validate" ion-button outline item-end [class.button-validate]="isItemValid(item)"
                    (click)="doValidate(order, item)">
              <ion-icon name="checkmark" ></ion-icon>
            </button>
            <button class="avoid" ion-button outline item-end [class.button-cancel]="isItemCancel(item)"
                    (click)="doCancel(order,item)">
              <ion-icon name="close" ></ion-icon>
            </button>
          </div>
        </div>
<!--
        <h3><span class="bold" [class.red]="item.quantity>1">{{item.quantity}}x</span> {{item.title}} </h3>
        <h2>    
          <span [hidden]="!item.variant"> 
            <span class="ion-alert-circled red">option: </span>{{item.variant?.title}}
          </span>
          <div class="price">
            <span class="suffix">fr</span>
            <input type="number" [(ngModel)]="item.finalprice"  class="input-price" />
          </div>
        </h2>
        <p>~500gr  </p>
        
        <button ion-button round item-end color="light">
           <ion-icon name="checkmark" ></ion-icon>
        </button>
        <button ion-button round item-end color="light">
           <ion-icon name="close" ></ion-icon>
        </button>-->

      </ion-item>
      <ion-item-options side="right">
        <a ion-button color="danger" href='tel:shop.address.phone'>
          <ion-icon name="call"></ion-icon>
          Appeler
        </a>        
      </ion-item-options>
    </ion-item-sliding>
  </ion-list>



</ion-content>
