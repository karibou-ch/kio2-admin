
<ion-header no-border>
  <logistic-header
    [vendor]="true"
    [stock]="true"
    [collect]="true"
    (doInitOrders)="onInitOrders($event)"
    (doSelectedOrders)="onSelectedOrders($event)">
  </logistic-header>
</ion-header>

<ion-content >
  <h1 class="info" [hidden]="!isReady||orders.length">Pas de commandes  pour la boutique {{vendor}} </h1>
  <ion-refresher 
    (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!-- DISPLAY ORDERS -->
  <ion-list>
    <ion-item-sliding *ngFor="let order of orders.sort(sortOrdersByPosition);let i=index;">
      <ion-item [class.selected]="isOrderSelected(order)" (click)="openOrder(order)">
        <ion-note item-end>
          <span class="price">{{order.getSubTotal()|number:'1.0-0'}} fr</span>            
          <span class="progress" [class.red]="!isFulfilled(order)">{{order.getProgress()|number:'1.0-0'}} %</span>            
        </ion-note>        
        <ion-avatar item-start>
          <!--<off-ion-icon name="radio-button-on" style="zoom:2.0;" color="primary"></off-ion-icon> -->
          <span class="rank">{{order.rank}}</span>
        </ion-avatar>
        <h3 text-capitalize>{{ order.oid }} - {{ order.shipping.name }}</h3>
        <h2><span class="label counter">{{i+1}}</span><span class="label">{{order.payment.status}}</span> {{order.getFulfilledProgress()}}/{{order.items.length}} </h2>
      </ion-item>
      <ion-item-options side="left" [hidden]="!user.isAdmin()">      
        <button ion-button expandable 
                (click)="orderCapture(order)" 
                [hidden]="!isOrderCapturable(order)">
          capture
        </button>          
        <button ion-button expandable 
                color="danger" 
                (click)="orderCancel(order)" 
                [hidden]="isOrderCapturable(order)">
          cancel
        </button>          
      </ion-item-options>    

      <ion-item-options side="right" class="shipping" [hidden]="!user.isAdmin()">
        <ion-label color="primary">Livraison</ion-label>
        <ion-select [(ngModel)]="order.payment.fees.shipping" color="primary" (ionChange)="orderShippingFees(order)" >
          <ion-option value="0">0.0 fr</ion-option>
          <ion-option value="4">4.0 fr</ion-option>
          <ion-option value="7.5">7.5 fr</ion-option>
          <ion-option value="10">10.0 fr</ion-option>
          <ion-option value="11.90">11.9 fr</ion-option>
          <ion-option value="14.90">14.9 fr</ion-option>
          <ion-option value="16.90">16.9 fr</ion-option>
        </ion-select>
      </ion-item-options>
          
    </ion-item-sliding>
  </ion-list>
</ion-content>
